import numpy as np

BASE_PLANE_THICKNESS = 2 * 1e-3
refractive_index_list = np.array([1.5308, 1.5296, 1.5283, 1.5274, 1.5263, 1.5253,  # 400~450nm
                                  1.5245, 1.5236, 1.5228, 1.5221, 1.5214, 1.5208,  # 460~510nm
                                  1.52015, 1.5196, 1.5190, 1.5185, 1.518, 1.5175,  # 520~570nm
                                  1.51707, 1.5167, 1.5163, 1.51585, 1.51545, 1.5151,  # 580~630nm
                                  1.5148, 1.51445, 1.51415, 1.51385, 1.5135, 1.51324,  # 640~690nm
                                  1.5131])  # 700nm

wave_length_list_400_700nm = np.array([400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550,
                                       560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700]) * 1e-9

wave_length_list_420_720nm = np.array([420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570,
                                       580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720]) * 1e-9


GMAX3265_BGR_31_CHANNEL_400_700NM = [
    [34.001, 39.631, 44.601, 46.397, 49.779, 52.120, 53.480,
     52.939, 48.516, 42.808, 32.875, 21.983, 13.910, 9.122,
     5.661, 4.450, 2.541, 1.665, 1.091, 0.839, 0.633,
     1.172, 0.275, 0.216, 1.142, 1.584, 1.612, 2.127,
     2.096, 2.286, 2.307],
    [4.053, 1.995, 2.596, 1.180, 2.146, 2.247, 2.945, 
     10.239, 32.302, 49.806, 57.621, 61.023, 62.78, 63.594,
     60.85, 59.605, 54.927, 50.437, 43.604, 37.457, 29.86,
     21.693, 13.609, 9.07, 7.631, 6.659, 5.579, 5.904,
     6.987, 9.173, 11.123],
    [6.502, 3.500, 3.436, 1.893, 1.484, 1.161, 1.466,
     1.581, 0.839, 1.443, 0.381, 0.287, 2.187, 3.255,
     1.148, 1.203, 1.041, 1.908, 15.524, 40.513, 44.452,
     43.701, 39.628, 38.459, 36.701, 35.212, 32.423, 30.200,
     28.271, 26.946, 25.981]
]

BFS_U3_200S7C_BGR_31_CHANNEL_400_700NM = [
    [29.5067029744449, 37.3031076066790, 41.6883116883117, 45.4702719155844, 48.6525974025974, 50.8246753246753, 48.9935064935065,
     48.0993810876623, 45.1583416583417, 38.6444805194805, 31.3636363636364, 22.7606823979592, 15.4805194805195, 10.8242984693878, 
     8.08441558441558, 5.81980519480520, 3.73904220779221, 2.60551948051949, 2.04545454545455, 1.65584415584416, 1.30275974025974, 
     1.07142857142857, 1.07142857142857, 1.36363636363636, 1.69237012987013, 2.27069805194804, 2.82467532467533, 2.82467532467533, 
     2.09821428571429, 1.21753246753248, 0.487012987012987],
    [11.7857142857143, 10.3733766233766, 8.86363636363636, 7.69480519480520, 9.11120129870130, 9.57893668831169, 11.1038961038961,
     22.4398191094620, 38.8501148728422, 49.7154798326673, 53.9610389610390, 56.4855925324675, 56.6883116883117, 56.8465909090909, 
     54.6428571428571, 53.2576095779221, 50.6006493506494, 47.2419990723562, 44.8051948051948, 39.8281011268143, 33.3177759740260,
     26.8193486201299, 21.3311688311688, 17.8523529522803, 15.6331168831169, 14.2892654220779, 13.3441558441558, 11.7641030844156,
     9.21150278293137, 5.54788961038963, 2.43506493506494],
    [6.29870129870130, 4.72402597402598, 3.40909090909091, 2.62987012987013, 2.20373376623377, 1.73802759740260, 1.46103896103896, 
     1.73507888595779, 2.14285714285714, 2.04545454545455, 2.14285714285714, 2.60095373376624, 3.85146103896104, 4.56955154220780, 
     3.21428571428571, 2.04545454545455, 1.85064935064935, 3.96259586318848, 18.1168831168831, 37.8467991806876, 43.2183441558442, 
     42.8571428571429, 42.6623376623377, 42.3990462662338, 41.0064935064935, 40.2059659090909, 38.1818181818182, 29.7339397671294, 
     18.4968602825746, 9.24000341763504, 3.70129870129870]
]

IMX430_BGR_31_CHANNEL_400_700NM = [
    [30.33998119, 38.5199428, 44.16936519, 48.80871098, 53.07220576,  56.56850391, 57.6711772, 
     56.67063842, 51.70483295, 44.25303516, 35.74875659, 25.89620525, 18.6347858, 13.21814802, 
     10.0041529,  7.114685715, 4.636171535, 3.266743836, 2.525264929, 2.085697957, 1.681398828, 
     1.467355559, 1.516624445, 1.887896951, 2.520951705, 3.329862374, 4.216468646, 4.855343446, 
     5.170535605, 5.298581267, 5.126628701],
    [5.685454084, 4.677678713, 3.669794621, 3.306567273, 3.625968633, 4.165338124, 6.931673044, 
     17.97530894, 36.15974985, 53.01582919,  61.77246672, 63.71216164, 66.60794627, 66.65963671, 
     67.63822723, 66.12798069, 62.55518579, 60.22100299, 54.88748491, 48.36363474,  38.35441076,
     28.7929543, 21.10517721, 16.55657415, 13.76629425, 11.86978336, 11.34846271, 12.38014316, 
     14.71304994, 17.68296404, 20.23731551],
    [6.707711291, 5.146710858, 3.812708144, 2.901509266, 2.282243506, 1.864748087, 1.672825555, 
     1.79084855,  1.886403477, 1.897887077, 2.103777936, 2.874041423, 4.199078252, 4.52978966, 
     3.659631826, 2.584838835, 2.691410391, 9.844042721, 30.39227239, 53.36722653, 63.53721284,
     64.6574792, 63.71477888, 62.85212387, 61.48918362,  59.10790363, 57.38254367, 54.32496947,
     50.54156215, 47.45521858, 45.88993084]
]



BFS_U3_51S5C_BGR_31_CHANNEL_400_700NM = [
    [28.2225475417440, 34.6523150145309, 38.5714285714286, 41.4074421672078, 45.7959183673469, 48.0194805194805, 47.7272727272727,
    46.8290381493507, 43.6437847866419, 37.0314871816495, 28.7337662337662, 20.8786712875940, 13.7652581793207, 9.43100649350652,
    7.01298701298701, 4.84030032467533, 3.11688311688312, 2.11394074675325, 1.85064935064935, 1.55844155844156, 1.36363636363636,
    1.16883116883117, 1.26623376623377, 1.54322240259741, 1.94805194805195, 2.65422077922077, 3.31168831168831, 3.53540990259740,
    2.53246753246754, 1.20840097402599, 0.584415584415584],
    [5.27597402597403, 4.33441558441559, 3.50649350649351, 2.89316152597403, 3.76217532467532, 4.04220779220779, 5.55194805194805,
    15.3925348548511, 35.4040181460685, 50.0793532125769, 55.8116883116883, 58.9894480519481, 59.5129870129870, 59.5023336038961,
    58.5389610389610, 56.7784090909091, 54.1155979437229, 50.5390117694805, 47.4350649350649, 40.8587287372953, 31.4610389610390,
    22.6021615284870, 16.4610389610390, 12.9734425730519, 10.9285714285714, 9.61394074675325, 8.86363636363636, 8.92146915584414,
    7.22016079158938, 4.01785714285716, 2.04545454545455],
    [5.71626489948408, 3.83578069657615, 2.92207792207792, 2.07589285714285, 1.65584415584416, 1.26623376623377, 1.07142857142857,
    1.36363636363636, 1.46103896103896, 1.26623376623377, 1.46103896103896, 2.20906047077922, 3.55519480519481, 4.27658279220780,
    3.01948051948052, 2.04545454545455, 2.08198051948052, 5.03588682921361, 23.8636363636364, 49.6034319258752, 54.7750463821892,
    54.6428571428571, 55.3246753246753, 54.0316558441558, 51.9886363636364, 51.5604997680891, 48.4090909090909, 42.4801426252318,
    26.0127227423740, 10.9586322261343, 4.57792207792208]
]


TS5MSGV_36M_C_BGR_31_CHANNEL_400_700NM = [
    [30.2329844825367, 38.4762760382625, 45.8504089227941, 50.8761845404412, 57.3614649748016, 61.5789244191177, 63.2121300496324,
    62.7233627463235, 57.8573139509804, 50.6724626470588, 39.8496122334352, 30.5318425923837, 21.6103345588235, 16.4451542156863, 
    11.6954204948257, 7.95388913970588, 6.28439166559001, 4.34506125000000, 3.61016996323529, 3.26005223161765, 2.89606417647059,
    2.69800905330882, 2.72558465073529, 3.27467630787039, 4.32010627941177, 5.63599293981481, 6.78458104547931, 7.55885333823529,
    8.39566804929191, 8.62403954847495, 8.43792467647059],
    [6.09887295036763, 5.03265521711086, 4.51078181382914, 4.31458808823529, 4.48773097426471, 5.40166003676471, 8.82448539154412,
    22.8772644684550, 43.8843491536990, 65.3312821985294, 75.8284931606507, 83.7056412119962, 86.0811659926471, 89.0807936952614, 
    90.4293409852941, 88.9389421985294, 86.0800639417665, 82.9732359872685, 76.8966202169118, 67.7597458923308, 54.1395110967617, 
    41.0097376102941, 30.2842738970589, 24.0182783316539, 20.1604959705882, 17.7522726637618, 17.6184574975490, 19.4370514411765,
    23.6938588161764, 28.7052947584877, 33.2243284136029],
    [6.79588700183823, 5.68182507239835, 4.68072043392187, 3.41571556985294, 2.87214782352941, 2.29403833660131, 2.16109846323529, 
    2.53793953308824, 2.70704853860294, 2.71459621323529, 3.03256312500000, 4.41835356876361, 5.94284200367647, 6.52056114705882, 
    5.73674162282135, 4.25144747787310, 4.43289032613601, 15.6386615110844, 45.8491585330882, 79.8079871432539, 95.5844832212302, 
    97.3081931893382, 98.1210474264706, 95.5899934007353, 95.0423381470588, 93.3055207636166, 91.2298210147059, 85.8469771985294,
    80.2172682806373, 77.0265659975490, 75.0623716011029]
]




SRF_BFS_U3_88S6C_BGR_31_CHANNEL_400_700NM = [
    [25.48056926, 32.0295047, 36.2201465, 40.31518369, 44.74030595, 47.14851744, 46.65955711, 44.97380174, 42.26016774,
     35.50004653, 28.03846041, 20.29787608, 13.70564397, 9.722325144, 7.231906373, 4.967853628, 3.202065046,
     2.184233507, 1.836285129, 1.586892531, 1.358943904, 1.135153799, 1.227590476, 1.478570507, 1.995882243,
     2.721188174, 3.229119508, 3.179894938, 2.283567161, 1.348137444, 0.724738245],
    [4.541990956, 3.663623834, 2.940528853, 2.403136639, 3.178005198, 3.453126694, 4.85343158, 14.03512197, 33.39800734,
     47.62034583, 54.48847378, 57.59346551, 58.32896981, 59.49236532, 58.14619524, 56.9795439, 54.01251751, 51.14137543,
     46.72132402, 40.14084711, 31.86925929, 22.59998581, 16.07258693, 12.67019122, 10.94002049, 9.722541053,
     8.643719849, 8.110262677, 6.516759071, 4.425741173, 2.760398465],
    [5.768328514, 4.374139336, 3.385539552, 2.621414425, 2.07330116, 1.541177365, 1.318625695, 1.475911458, 1.635881235,
     1.54427472, 1.674356288, 2.498723416, 3.924646443, 4.700923391, 3.323684517, 2.241798618, 2.227311666, 5.092952135,
     23.88502721, 49.5733748, 56.31405836, 55.62174719, 54.09312688, 52.67057051, 51.95888314, 51.70757456, 45.98410239,
     37.76307594, 22.96991029, 11.93699506, 6.234105082]
]

SRF_GS3_U3_41S4C_BGR_31_CHANNEL_400_700NM = [
    [18.73589729, 28.27536788, 34.26532218, 38.89578098, 43.92060554, 48.2447291, 49.34113124, 48.42053339, 45.65638999,
     39.93330299, 32.29464007, 23.01558074, 15.2443332, 10.07552324, 7.201548122, 5.080157997, 3.264370381, 2.297836673,
     1.812185775, 1.52638278, 1.125983598, 0.806662059, 0.587345148, 0.537235367, 0.686925654, 1.03072496, 1.226171082,
     1.139780943, 0.623173653, 0.374706952, 0.244239498],
    [6.425137553, 7.446242762, 8.096116496, 8.900800174, 10.36405115, 12.03762611, 14.42202255, 19.65569408,
     25.23192339, 28.83286975, 33.85398281, 42.82070851, 53.13000898, 59.61325583, 61.75104661, 59.59523025,
     53.90891291, 47.30047763, 40.19970471, 32.09065727, 23.35397023, 15.10836029, 9.611802365, 6.887123842,
     5.589670348, 5.345366907, 4.950957308, 4.0502356, 2.583613336, 1.465660475, 0.684460275],
    [7.111793475, 5.795795295, 4.319709787, 3.166535783, 2.451689508, 2.011189415, 1.765684355, 2.010858585,
     2.201868624, 2.451063484, 2.659444915, 3.44220031, 5.054634739, 6.803908502, 6.245753758, 4.315452, 4.102605146,
     5.592691346, 16.81750851, 41.22101035, 54.5222667, 56.03542013, 53.9843276, 50.13648326, 48.50472486, 46.65697227,
     42.49659626, 29.31238995, 14.30632494, 5.929299276, 2.348298176]
]

SRF_GS3_U3_41S4C_BGR_31_CHANNEL_420_720NM = [
    [34.26532218, 38.89578098, 43.92060554, 48.2447291, 49.34113124, 48.42053339, 45.65638999,
     39.93330299, 32.29464007, 23.01558074, 15.2443332, 10.07552324, 7.201548122, 5.080157997, 3.264370381, 2.297836673,
     1.812185775, 1.52638278, 1.125983598, 0.806662059, 0.587345148, 0.537235367, 0.686925654, 1.03072496, 1.226171082,
     1.139780943, 0.623173653, 0.374706952, 0.244239498, 0.19618741, 0.19618741],
    [8.096116496, 8.900800174, 10.36405115, 12.03762611, 14.42202255, 19.65569408,
     25.23192339, 28.83286975, 33.85398281, 42.82070851, 53.13000898, 59.61325583, 61.75104661, 59.59523025,
     53.90891291, 47.30047763, 40.19970471, 32.09065727, 23.35397023, 15.10836029, 9.611802365, 6.887123842,
     5.589670348, 5.345366907, 4.950957308, 4.0502356, 2.583613336, 1.465660475, 0.684460275, 0.44380837, 0.34332796],
    [4.319709787, 3.166535783, 2.451689508, 2.011189415, 1.765684355, 2.010858585,
     2.201868624, 2.451063484, 2.659444915, 3.44220031, 5.054634739, 6.803908502, 6.245753758, 4.315452, 4.102605146,
     5.592691346, 16.81750851, 41.22101035, 54.5222667, 56.03542013, 53.9843276, 50.13648326, 48.50472486, 46.65697227,
     42.49659626, 29.31238995, 14.30632494, 5.929299276, 2.348298176, 0.83657815, 0.59286653]
]

SRF_MOCK_BGR_31_CHANNEL_400_700NM = [
    # 400    410    420    430    440    450    460    470    480    490    500    510    520    530    540   550nm
    [0.005, 0.007, 0.012, 0.015, 0.023, 0.030, 0.026, 0.024, 0.019, 0.010, 0.004, 0.00000001, 0.00000001, 0.00000001,
     0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001,
     0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001],
    [0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.001, 0.002, 0.003, 0.005, 0.007, 0.012, 0.013, 0.015,
     0.016, 0.017, 0.020, 0.013, 0.011, 0.009, 0.005, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.002,
     0.002, 0.003],
    [0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001,
     0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.001, 0.003, 0.010, 0.012,
     0.013, 0.022, 0.020, 0.020, 0.018, 0.017, 0.016, 0.016, 0.014, 0.014, 0.013]
]

SRF_SAPPHIRE_S25A30CL_GRAY_31_CHANNEL_400_700NM = [
    39.52387622, 41.78260739, 43.71710988, 45.11623167, 46.30035537, 46.49899111, 47.17580019, 47.61406605, 47.51952076,
    48.72762724, 48.73404593, 50.70525556, 49.54251896, 50.26305817, 49.84265098, 49.42455289, 48.62886524, 49.06245476,
    48.07280128, 48.3340762, 48.62673229, 47.45452408, 47.00466159, 49.23973623, 46.00812168, 45.05571193, 45.26041172,
    43.49890985, 40.28837998, 41.36890754, 40.91668654
]


def refractive_index_noa61(wavelength, a=1.5375, b=0.00829045, c=-0.000211046):
    """ NOA61 dispersion formula
    https://refractiveindex.info/?shelf=other&book=Optical_adhesives&page=Norland_NOA61
    """
    return a + b / (wavelength * 1e6) ** 2 + c / (wavelength * 1e6) ** 4


def refractive_index_glass_bk7(wavelength):
    # dispersion formula
    wavelength_square = (wavelength * 1e6) ** 2
    # B1*λ^2 / (λ^2-C1)
    first = (1.03961212 * wavelength_square) / (wavelength_square - 0.00600069867)
    # B2*λ^2 / (λ^2-C2)
    second = (0.231792344 * wavelength_square) / (wavelength_square - 0.0200179144)
    # B3*λ^2 / (λ^2-C3)
    third = (1.01046945 * wavelength_square) / (wavelength_square - 103.560653)
    return ((first + second + third) + 1) ** 0.5


def refractive_index_glass_ohara_sk1300(wavelength):
    wavelength_square = (wavelength * 1e6) ** 2
    # B1*λ^2 / (λ^2-C1)
    first = (7.44386780E-01 * wavelength_square) / (wavelength_square - 4.95119834E-03)
    # B2*λ^2 / (λ^2-C2)
    second = (3.60198890E-01 * wavelength_square) / (wavelength_square - 1.41130274E-02)
    # B3*λ^2 / (λ^2-C3)
    third = (9.18623119E-01 * wavelength_square) / (wavelength_square - 1.00428510E+02)
    return ((first + second + third) + 1) ** 0.5


MATERIAL_REFRACTIVE_INDEX_FUNCS = {
    "NOA61": refractive_index_noa61,
    "BK7": refractive_index_glass_bk7,
    "SK1300": refractive_index_glass_ohara_sk1300
}
